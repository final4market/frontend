{"ast":null,"code":"import React,{useState,useEffect}from'react';import MypageSideBar from'./MypageSideBar';import axios from'axios';import styles from'./css/MypageProductSalesList.module.css';import MypagReviewWrite from'./MypagReviewWrite';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MypageProductPurchaseHistory=()=>{const[memberProductList,setMemberProductList]=useState([]);const[showReviewForm,setShowReviewForm]=useState({});// 리뷰 작성 폼 상태\nconst buyerId='member5';const readData=async()=>{try{const response=await axios.get(\"http://localhost:9999/member/ProductPurchaseHistory/\".concat(buyerId));console.log(response.data);// 응답 데이터 구조 확인\nsetMemberProductList(response.data);}catch(error){console.error('Error fetching member list:',error);}};useEffect(()=>{readData();},[]);// 숫자를 천 단위로 구분하여 포맷팅하는 함수\nconst formatPrice=price=>{return new Intl.NumberFormat('ko-KR').format(price);// 한국 원화 형식\n};// 날짜에 14일을 더한 값을 계산하는 함수\nconst addDaysToDate=(dateStr,days)=>{const date=new Date(dateStr);date.setDate(date.getDate()+days);return date.toISOString().split('T')[0];// 'YYYY-MM-DD' 형식으로 반환\n};// 현재 날짜와 기한 날짜 사이의 일수 차이를 계산하는 함수\nconst calculateDday=dateStr=>{const today=new Date();const deadline=new Date(dateStr);const timeDiff=deadline-today;const dayDiff=Math.ceil(timeDiff/(1000*60*60*24));// 밀리초를 일수로 변환\nreturn dayDiff;};// 리뷰 작성 가능/불가능 항목 분류\nconst[reviewWritable,reviewExpired]=memberProductList.reduce((acc,memberProduct)=>{const deadline=addDaysToDate(memberProduct.thDate,14);const dDay=calculateDday(deadline);if(dDay>=0){acc[0].push({...memberProduct,deadline,dDay});}else{acc[1].push({...memberProduct,deadline});}return acc;},[[],[]]);// 구매후기 작성 버튼 클릭 핸들러\nconst handleReviewButtonClick=index=>{setShowReviewForm(prev=>({...prev,[index]:!prev[index]// 클릭할 때마다 폼 보이기/숨기기 토글\n}));};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:styles.MypageProductSalesListComponent,children:[/*#__PURE__*/_jsx(MypageSideBar,{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\uCD5C\\uADFC\\uAD6C\\uB9E4\\uB0B4\\uC5ED (\",reviewWritable.length,\")\"]}),reviewWritable.map((memberProduct,index)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.MypageProductSalesList,children:[/*#__PURE__*/_jsx(\"img\",{className:styles.ProductSalesimg,src:memberProduct.productImagePath,alt:\"Product\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.ProductSalestext,children:[/*#__PURE__*/_jsxs(\"p\",{className:styles.ProductSalesthDate,children:[\"\\uAD6C\\uB9E4\\uD655\\uC815\\uC77C : \",memberProduct.thDate]}),/*#__PURE__*/_jsx(\"p\",{className:styles.productTitle,children:memberProduct.productTitle}),/*#__PURE__*/_jsxs(\"p\",{className:styles.productPrice,children:[\"\\uFFE6\",formatPrice(memberProduct.productPrice)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.reviewWrite,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.reviewWriteButton,onClick:()=>handleReviewButtonClick(index),children:\"\\uAD6C\\uB9E4\\uD6C4\\uAE30 \\uC791\\uC131\\uD558\\uAE30\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC791\\uC131\\uAE30\\uD55C : \",memberProduct.deadline,\" (\",\"D-\".concat(memberProduct.dDay),\")\"]})]})]}),showReviewForm[index]&&/*#__PURE__*/_jsx(MypagReviewWrite,{productNo:memberProduct.productNo,buyerId:buyerId,sellerId:memberProduct.memberId})]},index)),/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\uAD6C\\uB9E4\\uB0B4\\uC5ED(\",reviewExpired.length,\")\"]}),reviewExpired.map((memberProduct,index)=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:styles.MypageProductSalesList,children:[/*#__PURE__*/_jsx(\"img\",{className:styles.ProductSalesimg,src:memberProduct.productImagePath,alt:\"Product\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.ProductSalestext,children:[/*#__PURE__*/_jsxs(\"p\",{className:styles.ProductSalesthDate,children:[\"\\uAD6C\\uB9E4\\uD655\\uC815\\uC77C : \",memberProduct.thDate]}),/*#__PURE__*/_jsx(\"p\",{className:styles.productTitle,children:memberProduct.productTitle}),/*#__PURE__*/_jsxs(\"p\",{className:styles.productPrice,children:[\"\\uFFE6\",formatPrice(memberProduct.productPrice)]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.reviewWrite,children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uC791\\uC131\\uAE30\\uD55C : \",memberProduct.deadline,\" (\\uAE30\\uD55C \\uCD08\\uACFC)\"]})})]})},index))]})]})});};export default MypageProductPurchaseHistory;","map":{"version":3,"names":["React","useState","useEffect","MypageSideBar","axios","styles","MypagReviewWrite","jsx","_jsx","jsxs","_jsxs","MypageProductPurchaseHistory","memberProductList","setMemberProductList","showReviewForm","setShowReviewForm","buyerId","readData","response","get","concat","console","log","data","error","formatPrice","price","Intl","NumberFormat","format","addDaysToDate","dateStr","days","date","Date","setDate","getDate","toISOString","split","calculateDday","today","deadline","timeDiff","dayDiff","Math","ceil","reviewWritable","reviewExpired","reduce","acc","memberProduct","thDate","dDay","push","handleReviewButtonClick","index","prev","children","className","MypageProductSalesListComponent","length","map","MypageProductSalesList","ProductSalesimg","src","productImagePath","alt","ProductSalestext","ProductSalesthDate","productTitle","productPrice","reviewWrite","reviewWriteButton","onClick","productNo","sellerId","memberId"],"sources":["D:/workspace/final_4market_frontend/src/components/myPage/MypageProductPurchaseHistory.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport MypageSideBar from './MypageSideBar';\r\nimport axios from 'axios';\r\nimport styles from './css/MypageProductSalesList.module.css';\r\nimport MypagReviewWrite from './MypagReviewWrite';\r\n\r\nconst MypageProductPurchaseHistory = () => {\r\n  const [memberProductList, setMemberProductList] = useState([]);\r\n  const [showReviewForm, setShowReviewForm] = useState({}); // 리뷰 작성 폼 상태\r\n  const buyerId = 'member5';\r\n\r\n  const readData = async () => {\r\n    try {\r\n      const response = await axios.get(`http://localhost:9999/member/ProductPurchaseHistory/${buyerId}`);\r\n      console.log(response.data); // 응답 데이터 구조 확인\r\n      setMemberProductList(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching member list:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    readData();\r\n  }, []);\r\n\r\n  // 숫자를 천 단위로 구분하여 포맷팅하는 함수\r\n  const formatPrice = (price) => {\r\n    return new Intl.NumberFormat('ko-KR').format(price); // 한국 원화 형식\r\n  };\r\n\r\n  // 날짜에 14일을 더한 값을 계산하는 함수\r\n  const addDaysToDate = (dateStr, days) => {\r\n    const date = new Date(dateStr);\r\n    date.setDate(date.getDate() + days);\r\n    return date.toISOString().split('T')[0]; // 'YYYY-MM-DD' 형식으로 반환\r\n  };\r\n\r\n  // 현재 날짜와 기한 날짜 사이의 일수 차이를 계산하는 함수\r\n  const calculateDday = (dateStr) => {\r\n    const today = new Date();\r\n    const deadline = new Date(dateStr);\r\n    const timeDiff = deadline - today;\r\n    const dayDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24)); // 밀리초를 일수로 변환\r\n    return dayDiff;\r\n  };\r\n\r\n  // 리뷰 작성 가능/불가능 항목 분류\r\n  const [reviewWritable, reviewExpired] = memberProductList.reduce(\r\n    (acc, memberProduct) => {\r\n      const deadline = addDaysToDate(memberProduct.thDate, 14);\r\n      const dDay = calculateDday(deadline);\r\n      if (dDay >= 0) {\r\n        acc[0].push({ ...memberProduct, deadline, dDay });\r\n      } else {\r\n        acc[1].push({ ...memberProduct, deadline });\r\n      }\r\n      return acc;\r\n    },\r\n    [[], []]\r\n  );\r\n\r\n  // 구매후기 작성 버튼 클릭 핸들러\r\n  const handleReviewButtonClick = (index) => {\r\n    setShowReviewForm((prev) => ({\r\n      ...prev,\r\n      [index]: !prev[index], // 클릭할 때마다 폼 보이기/숨기기 토글\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className={styles.MypageProductSalesListComponent}>\r\n        <MypageSideBar />\r\n        <div>\r\n          <h3>최근구매내역 ({reviewWritable.length})</h3>\r\n          {reviewWritable.map((memberProduct, index) => (\r\n            <div key={index}>\r\n              <div className={styles.MypageProductSalesList}>\r\n                <img className={styles.ProductSalesimg} src={memberProduct.productImagePath} alt=\"Product\" />\r\n                <div className={styles.ProductSalestext}>\r\n                  <p className={styles.ProductSalesthDate}>구매확정일 : {memberProduct.thDate}</p>\r\n                  <p className={styles.productTitle}>{memberProduct.productTitle}</p>\r\n                  <p className={styles.productPrice}>￦{formatPrice(memberProduct.productPrice)}</p>\r\n                </div>\r\n                <div className={styles.reviewWrite}>\r\n                  <button\r\n                    className={styles.reviewWriteButton}\r\n                    onClick={() => handleReviewButtonClick(index)}\r\n                  >\r\n                    구매후기 작성하기\r\n                  </button>\r\n                  <p>작성기한 : {memberProduct.deadline} ({`D-${memberProduct.dDay}`})</p>\r\n                </div>\r\n              </div>\r\n              {showReviewForm[index] && <MypagReviewWrite\r\n                productNo={memberProduct.productNo}\r\n                buyerId={buyerId}\r\n                sellerId={memberProduct.memberId}\r\n\r\n              />}\r\n            </div>\r\n          ))}\r\n\r\n          <h3>구매내역({reviewExpired.length})</h3>\r\n          {reviewExpired.map((memberProduct, index) => (\r\n            <div key={index}>\r\n              <div className={styles.MypageProductSalesList}>\r\n                <img className={styles.ProductSalesimg} src={memberProduct.productImagePath} alt=\"Product\" />\r\n                <div className={styles.ProductSalestext}>\r\n                  <p className={styles.ProductSalesthDate}>구매확정일 : {memberProduct.thDate}</p>\r\n                  <p className={styles.productTitle}>{memberProduct.productTitle}</p>\r\n                  <p className={styles.productPrice}>￦{formatPrice(memberProduct.productPrice)}</p>\r\n                </div>\r\n                <div className={styles.reviewWrite}>\r\n                  <p>작성기한 : {memberProduct.deadline} (기한 초과)</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MypageProductPurchaseHistory;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}